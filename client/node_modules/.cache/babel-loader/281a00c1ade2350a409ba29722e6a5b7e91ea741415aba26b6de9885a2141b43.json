{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\dell\\\\Desktop\\\\Flight-Booking-App-MERN\\\\client\\\\src\\\\pages\\\\Bookings.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport '../styles/Bookings.css';\nimport axios from 'axios';\nimport { jsPDF } from \"jspdf\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Bookings = () => {\n  _s();\n  const [bookings, setBookings] = useState([]);\n  const [userRole, setUserRole] = useState(\"\");\n  const [loading, setLoading] = useState(true);\n  const userId = localStorage.getItem('userId');\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        // 1. Fetch User details\n        const userRes = await axios.get(`http://localhost:6001/fetch-user/${userId}`);\n        setUserRole(userRes.data.usertype);\n\n        // 2. Fetch All Bookings\n        const bookingsRes = await axios.get('http://localhost:6001/fetch-bookings');\n        setBookings(bookingsRes.data.reverse());\n        setLoading(false);\n      } catch (err) {\n        console.error(\"Fetch error:\", err);\n        setLoading(false);\n      }\n    };\n    fetchData();\n  }, [userId]);\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"text-center mt-5\",\n    children: \"Loading Bookings...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 31,\n    columnNumber: 23\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"user-bookingsPage\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        background: '#eee',\n        padding: '10px',\n        textAlign: 'center',\n        fontSize: '0.8rem'\n      },\n      children: [\"DEBUG INFO: Your Logged-in Role is: \", /*#__PURE__*/_jsxDEV(\"b\", {\n        children: [\"\\\"\", userRole, \"\\\"\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 45\n      }, this), \" | Total Bookings in DB: \", /*#__PURE__*/_jsxDEV(\"b\", {\n        children: bookings.length\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 31\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      style: {\n        textAlign: 'center',\n        margin: '20px 0'\n      },\n      children: userRole === 'admin' || userRole === 'flight-operator' ? \"Operator Management View\" : \"My Bookings\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"user-bookings\",\n      children: bookings.filter(booking => {\n        // THE ULTIMATE BYPASS\n        // We check for 'admin' or 'flight-operator'\n        // We also add a check for 'flightoperator' (without hyphen) just in case\n        const isStaff = userRole === 'admin' || userRole === 'flight-operator' || userRole === 'flightoperator';\n        if (isStaff) {\n          return true; // Show everything if you are staff\n        }\n\n        return booking.user === userId; // Show only personal if you are a user\n      }).map(booking => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"user-booking\",\n        style: {\n          border: '1px solid #ccc',\n          margin: '10px',\n          padding: '15px',\n          borderRadius: '8px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Booking ID:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 20\n          }, this), \" \", booking._id]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Email:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 66,\n            columnNumber: 20\n          }, this), \" \", booking.email]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Flight:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 20\n          }, this), \" \", booking.flightName, \" (\", booking.flightId, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Route:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 20\n          }, this), \" \", booking.departure, \" to \", booking.destination]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Status:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 20\n          }, this), \" \", booking.bookingStatus]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Seats:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 20\n          }, this), \" \", booking.seats]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 17\n        }, this)]\n      }, booking._id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 34,\n    columnNumber: 5\n  }, this);\n};\n_s(Bookings, \"bAZPiobdyhQyo/Lkvon9kVHxo4Y=\");\n_c = Bookings;\nexport default Bookings;\nvar _c;\n$RefreshReg$(_c, \"Bookings\");","map":{"version":3,"names":["React","useEffect","useState","axios","jsPDF","jsxDEV","_jsxDEV","Bookings","_s","bookings","setBookings","userRole","setUserRole","loading","setLoading","userId","localStorage","getItem","fetchData","userRes","get","data","usertype","bookingsRes","reverse","err","console","error","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","background","padding","textAlign","fontSize","length","margin","filter","booking","isStaff","user","map","border","borderRadius","_id","email","flightName","flightId","departure","destination","bookingStatus","seats","_c","$RefreshReg$"],"sources":["C:/Users/dell/Desktop/Flight-Booking-App-MERN/client/src/pages/Bookings.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport '../styles/Bookings.css'\r\nimport axios from 'axios';\r\nimport { jsPDF } from \"jspdf\"; \r\n\r\nconst Bookings = () => {\r\n  const [bookings, setBookings] = useState([]);\r\n  const [userRole, setUserRole] = useState(\"\"); \r\n  const [loading, setLoading] = useState(true);\r\n  const userId = localStorage.getItem('userId');\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        // 1. Fetch User details\r\n        const userRes = await axios.get(`http://localhost:6001/fetch-user/${userId}`);\r\n        setUserRole(userRes.data.usertype);\r\n        \r\n        // 2. Fetch All Bookings\r\n        const bookingsRes = await axios.get('http://localhost:6001/fetch-bookings');\r\n        setBookings(bookingsRes.data.reverse());\r\n        setLoading(false);\r\n      } catch (err) {\r\n        console.error(\"Fetch error:\", err);\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchData();\r\n  }, [userId]);\r\n\r\n  if (loading) return <div className=\"text-center mt-5\">Loading Bookings...</div>;\r\n\r\n  return (\r\n    <div className=\"user-bookingsPage\">\r\n      \r\n      {/* DEBUG SECTION: Delete this once it works */}\r\n      <div style={{background: '#eee', padding: '10px', textAlign: 'center', fontSize: '0.8rem'}}>\r\n        DEBUG INFO: Your Logged-in Role is: <b>\"{userRole}\"</b> | \r\n        Total Bookings in DB: <b>{bookings.length}</b>\r\n      </div>\r\n\r\n      <h1 style={{textAlign: 'center', margin: '20px 0'}}>\r\n        {userRole === 'admin' || userRole === 'flight-operator' ? \"Operator Management View\" : \"My Bookings\"}\r\n      </h1>\r\n\r\n      <div className=\"user-bookings\">\r\n        {bookings\r\n          .filter(booking => {\r\n            // THE ULTIMATE BYPASS\r\n            // We check for 'admin' or 'flight-operator'\r\n            // We also add a check for 'flightoperator' (without hyphen) just in case\r\n            const isStaff = (\r\n                userRole === 'admin' || \r\n                userRole === 'flight-operator' || \r\n                userRole === 'flightoperator'\r\n            );\r\n\r\n            if (isStaff) {\r\n                return true; // Show everything if you are staff\r\n            }\r\n            return booking.user === userId; // Show only personal if you are a user\r\n          })\r\n          .map((booking) => (\r\n            <div className=\"user-booking\" key={booking._id} style={{border: '1px solid #ccc', margin: '10px', padding: '15px', borderRadius: '8px'}}>\r\n                <p><b>Booking ID:</b> {booking._id}</p>\r\n                <p><b>Email:</b> {booking.email}</p>\r\n                <p><b>Flight:</b> {booking.flightName} ({booking.flightId})</p>\r\n                <p><b>Route:</b> {booking.departure} to {booking.destination}</p>\r\n                <p><b>Status:</b> {booking.bookingStatus}</p>\r\n                <p><b>Seats:</b> {booking.seats}</p>\r\n            </div>\r\n          ))}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Bookings;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}